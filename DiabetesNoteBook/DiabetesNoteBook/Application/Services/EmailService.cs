using MailKit.Security;
using MimeKit;
using MimeKit.Text;
using SmtpClient = MailKit.Net.Smtp.SmtpClient;
using DiabetesNoteBook.Infrastructure.Interfaces;
using DiabetesNoteBook.Domain.Models;
using Microsoft.EntityFrameworkCore;
using DiabetesNoteBook.Application.Interfaces;
using DiabetesNoteBook.Application.DTOs;

namespace DiabetesNoteBook.Application.Services
{
    public class EmailService : IEmailService
    {
        private readonly IConfiguration _config;
        private readonly IHttpContextAccessor _httpContextAccessor;
        private readonly INewStringGuid _newStringGuid;
        private readonly DiabetesNoteBookContext _context;

        public EmailService(IConfiguration config, IHttpContextAccessor httpContextAccessor, INewStringGuid newStringGuid, DiabetesNoteBookContext context)
        {
            _config = config;
            _httpContextAccessor = httpContextAccessor;
            _newStringGuid = newStringGuid;
            _context = context;
        }

        public async Task SendEmailAsyncRegister(DTOEmail userData)
        {

            var usuarioDB = await _context.Usuarios.AsTracking().FirstOrDefaultAsync(x => x.Email == userData.ToEmail);

            Guid miGuid = Guid.NewGuid();
            string textoEnlace = Convert.ToBase64String(miGuid.ToByteArray());
            textoEnlace = textoEnlace.Replace("=", "").Replace("+", "").Replace("/", "").Replace("?", "").Replace("&", "").Replace("!", "").Replace("¡", "");
            usuarioDB.EnlaceCambioPass = textoEnlace;

            await _newStringGuid.SaveNewStringGuid(usuarioDB);
            var ruta = $"<!DOCTYPE html>\r\n<html xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" lang=\"en\">\r\n\r\n<head>\r\n\t<title></title>\r\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n\t<!--[if mso]><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch><o:AllowPNG/></o:OfficeDocumentSettings></xml><![endif]--><!--[if !mso]><!-->\r\n\t<link href=\"https://fonts.googleapis.com/css?family=Montserrat\" rel=\"stylesheet\" type=\"text/css\"><!--<![endif]-->\r\n\t<script type=\"text/javascript\"\r\n\t\tsrc=\"https://ff.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=VjO01f5t5umXDZhqfybIWapjEhVbloW61ESG50GPvlYMrpS1pQhHuDJEdQ7Zc5p7tfO5-T1k3Tx-_huxbBK7-LRtcQkBOYlHh1V0CTJ9VzAsYmJRp-YRIlJ0AJ_ADdhXKPE_C5wLdPmEBFh6LKJwatTmsMzrdjb4yAgEyrQ_CGUWOI_OjZJuSc2YBdGTte3pLxp-RVrirF5mJGel-nb6c1eMzys7hyP4uWQFkDJb-6TXRcKeAS-jKK6hDWzWmjobUSJZv-BR4jg4XS83taYfQV5qFQHSbs7NWexZnj3_2N3nZoe4FosaIcivSP-4VepC\"\r\n\t\tcharset=\"UTF-8\"></script>\r\n\t<link rel=\"stylesheet\" crossorigin=\"anonymous\"\r\n\t\thref=\"https://ff.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE4NzMzMDg5NzAyMDcyMzIyNi8xMjAxNDg3MjA3NjIyNTA4NjA0L2RlZmluaXRpdm9fMjAyNC0wMS0yOFQxMDI5MDUuODEwOTMxLmh0bWw_ZXg9NjVjOWZmMjgmaXM9NjViNzhhMjgmaG09NmNhNDg1M2RlODQyNmU1ODA5ZWMzNDIwNTMzOGQxNmY3YWJlZTBjNTRlYWFjY2M3YmM4ZTEzNmFjYWQ4YTc5MSY\" />\r\n\t<style>\r\n\t\t* {{\r\n\t\t\tbox-sizing: border-box;\r\n\t\t}}\r\n\r\n\t\tbody {{\r\n\t\t\tmargin: 0;\r\n\t\t\tpadding: 0;\r\n\t\t}}\r\n\r\n\t\ta[x-apple-data-detectors] {{\r\n\t\t\tcolor: inherit !important;\r\n\t\t\ttext-decoration: inherit !important;\r\n\t\t}}\r\n\r\n\t\t#MessageViewBody a {{\r\n\t\t\tcolor: inherit;\r\n\t\t\ttext-decoration: none;\r\n\t\t}}\r\n\r\n\t\tp {{\r\n\t\t\tline-height: inherit\r\n\t\t}}\r\n\r\n\t\t.desktop_hide,\r\n\t\t.desktop_hide table {{\r\n\t\t\tmso-hide: all;\r\n\t\t\tdisplay: none;\r\n\t\t\tmax-height: 0px;\r\n\t\t\toverflow: hidden;\r\n\t\t}}\r\n\r\n\t\t.image_block img+div {{\r\n\t\t\tdisplay: none;\r\n\t\t}}\r\n\r\n\t\t@media (max-width:655px) {{\r\n\r\n\t\t\t.desktop_hide table.icons-inner,\r\n\t\t\t.social_block.desktop_hide .social-table {{\r\n\t\t\t\tdisplay: inline-block !important;\r\n\t\t\t}}\r\n\r\n\t\t\t.icons-inner {{\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}}\r\n\r\n\t\t\t.icons-inner td {{\r\n\t\t\t\tmargin: 0 auto;\r\n\t\t\t}}\r\n\r\n\t\t\t.mobile_hide {{\r\n\t\t\t\tdisplay: none;\r\n\t\t\t}}\r\n\r\n\t\t\t.row-content {{\r\n\t\t\t\twidth: 100% !important;\r\n\t\t\t}}\r\n\r\n\t\t\t.stack .column {{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}}\r\n\r\n\t\t\t.mobile_hide {{\r\n\t\t\t\tmin-height: 0;\r\n\t\t\t\tmax-height: 0;\r\n\t\t\t\tmax-width: 0;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\tfont-size: 0px;\r\n\t\t\t}}\r\n\r\n\t\t\t.desktop_hide,\r\n\t\t\t.desktop_hide table {{\r\n\t\t\t\tdisplay: table !important;\r\n\t\t\t\tmax-height: none !important;\r\n\t\t\t}}\r\n\t\t}}\r\n\t</style>\r\n</head>\r\n\r\n<body style=\"background-color: #FFFFFF; margin: 0; padding: 0; -webkit-text-size-adjust: none; text-size-adjust: none;\">\r\n\t<table class=\"nl-container\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #FFFFFF;\">\r\n\t\t<tbody>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<table class=\"row row-1\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1; background-image: url('https://d1oco4z2z1fhwp.cloudfront.net/templates/default/6451/bg_hero_nut.png'); background-position: center top; background-repeat: no-repeat;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 635px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"635\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:35px;line-height:35px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; color: #000000; font-family: inherit; font-size: 14px; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"alignment\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\" align=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img class=\"icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://cdn.discordapp.com/attachments/1190453964605493328/1201495964268122144/logoTexto.png?ex=65ca0750&is=65b79250&hm=7bee5c5d02a89494bdbfb1861f505bcecf642d48e6b4e71434b00d0417e777e6&\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"32\" width=\"234\" align=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; margin: 0 auto; border: 0;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-4\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\" style=\"text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #1e251c; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 44px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: center; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 52.8px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tinyMce-placeholder\"></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-5\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\" style=\"text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #1e251c; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 31px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: center; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 37.199999999999996px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tinyMce-placeholder\">Tu salud esta en\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttus Dedos</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-6\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:10px;line-height:10px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-7\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-8\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-2\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-position: center top;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 635px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"635\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"50%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:45px;line-height:45px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h2\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #033f4d; direction: ltr; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 18px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 21.599999999999998px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tinyMce-placeholder\">Te damos la\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBienvenida</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-3\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:5px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #171614; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 30px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tinyMce-placeholder\">CONFIRMA TU\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tRESGISTRO AQUÍ</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"button_block block-4\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:10px;padding-right:10px;padding-top:20px;text-align:left;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"alignment\" align=\"left\"><!--[if mso]>\r\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"www.example.com\" style=\"height:42px;width:109px;v-text-anchor:middle;\" arcsize=\"10%\" stroke=\"false\" fillcolor=\"#033f4d\">\r\n<w:anchorlock/>\r\n<v:textbox inset=\"0px,0px,0px,0px\">\r\n<center style=\"color:#ffffff; font-family:Tahoma, sans-serif; font-size:16px\">\r\n<![endif]--><a href=\"{{_httpContextAccessor.HttpContext.Request.Scheme}}://{{_httpContextAccessor.HttpContext.Request.Host}}/api/Users/validarRegistro/{{usuarioDB.Id}}/{{textoEnlace}}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"text-decoration:none;display:inline-block;color:#ffffff;background-color:#033f4d;border-radius:4px;width:auto;border-top:0px solid transparent;font-weight:400;border-right:0px solid transparent;border-bottom:0px solid transparent;border-left:0px solid transparent;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:16px;text-align:center;mso-border-alt:none;word-break:keep-all;\"><span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;letter-spacing:normal;\"><span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"word-break: break-word; line-height: 32px;\">Confirma&nbsp;</span></span></a><!--[if mso]></center></v:textbox></v:roundrect><![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"paragraph_block block-5\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:15px;padding-left:10px;padding-right:10px;padding-top:10px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"color:#7a7a7a;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;font-size:17px;line-height:180%;text-align:left;mso-line-height-alt:30.6px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">Nos alegra mucho tenerte aquí\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomo parte de nuestra comunidad.</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">&nbsp;</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">No respondas a este email, eso\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tno confirmara tu dirección email. Para confirmar\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel proceso de confirmación debes hacer clic en\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel link de mas arriba.</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">&nbsp;</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">&nbsp;</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">&nbsp;</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-2\" width=\"50%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"image_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:30px;padding-left:5px;padding-top:60px;width:100%;padding-right:0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"alignment\" align=\"right\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"line-height:10px\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style=\"max-width: 311px;\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/imported/hBCl-20240123-100606/imported/TRge-20240122-193812/logo.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; border: 0; width: 100%;\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"311\" alt=\"Happy Girl\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Happy Girl\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-3\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 635px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"635\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-4\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 635px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"635\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"33.333333333333336%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; color: #000000; font-family: inherit; font-size: 14px; padding-left: 10px; padding-right: 10px; text-align: left;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"alignment\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\" align=\"left\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img class=\"icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/imported/hBCl-20240123-100606/logoTexto%20%282%29.svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"16\" width=\"117\" align=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; margin: 0 auto; border: 0;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"paragraph_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:20px;padding-right:20px;padding-top:10px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"color:#033f4d;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:14px;line-height:200%;text-align:left;mso-line-height-alt:28px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">Tu salud esta en</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">tus dedos...</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0;\">¡Descúbrenos!</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-2\" width=\"33.333333333333336%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-left:20px;text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #033f4d; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 18px; font-weight: normal; line-height: 200%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>Links</strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"social_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:20px;padding-right:10px;padding-top:10px;text-align:left;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"alignment\" align=\"left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"social-table\" width=\"144px\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"padding:0 4px 0 0;\"><a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"https://www.facebook.com\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/circle-blue/facebook@2x.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"32\" height=\"32\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Facebook\" title=\"facebook\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; border: 0;\"></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"padding:0 4px 0 0;\"><a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"https://www.twitter.com\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/circle-blue/twitter@2x.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"32\" height=\"32\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Twitter\" title=\"twitter\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; border: 0;\"></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"padding:0 4px 0 0;\"><a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"https://www.linkedin.com\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/circle-blue/linkedin@2x.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"32\" height=\"32\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Linkedin\" title=\"linkedin\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; border: 0;\"></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"padding:0 4px 0 0;\"><a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"https://www.instagram.com\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/circle-blue/instagram@2x.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"32\" height=\"32\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Instagram\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"instagram\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; border: 0;\"></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-3\" width=\"33.333333333333336%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-left:20px;text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #003f4d; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 18px; font-weight: normal; line-height: 200%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>Contacto</strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"paragraph_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:20px;padding-right:20px;padding-top:10px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"color:#033f4d;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:14px;line-height:120%;text-align:left;mso-line-height-alt:16.8px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p style=\"margin: 0; word-break: break-word;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tglucontrol@gmail.com</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"paragraph_block block-3\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:20px;padding-right:20px;padding-top:10px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"color:#033f4d;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:14px;line-height:120%;text-align:left;mso-line-height-alt:16.8px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&nbsp;</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-5\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 635px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"635\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-6\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff; color: #000000; width: 635px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"635\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; color: #1e0e4b; font-family: 'Inter', sans-serif; font-size: 15px; padding-bottom: 5px; padding-top: 5px; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"alignment\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--[if vml]><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"display:inline-block;padding-left:0px;padding-right:0px;mso-table-lspace: 0pt;mso-table-rspace: 0pt;\"><![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--[if !vml]><!-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons-inner\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block; margin-right: -4px; padding-left: 0px; padding-right: 0px;\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\"><!--<![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 6px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"http://designedwithbeefree.com/\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"text-decoration: none;\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Beefree Logo\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://d1oco4z2z1fhwp.cloudfront.net/assets/Beefree-logo.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"32\" width=\"34\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; margin: 0 auto; border: 0;\"></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"font-family: 'Inter', sans-serif; font-size: 15px; font-weight: undefined; color: #1e0e4b; vertical-align: middle; letter-spacing: undefined; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"http://designedwithbeefree.com/\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"color: #1e0e4b; text-decoration: none;\">Designed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twith Beefree</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table><!-- End -->\r\n</body>\r\n\r\n</html>";

            var email = new MimeMessage();
            email.From.Add(MailboxAddress.Parse(_config.GetSection("Email:UserName").Value));
            email.To.Add(MailboxAddress.Parse(userData.ToEmail));
            email.Subject = "Confirmar Email";
            email.Body = new TextPart(TextFormat.Html)
            {
                Text = ruta
            };

            using var smtp = new SmtpClient();
            await smtp.ConnectAsync(
                _config.GetSection("Email:Host").Value,
                Convert.ToInt32(_config.GetSection("Email:Port").Value),
                SecureSocketOptions.StartTls
            );

            await smtp.AuthenticateAsync(_config.GetSection("Email:UserName").Value, _config.GetSection("Email:PassWord").Value);
            await smtp.SendAsync(email);
            await smtp.DisconnectAsync(true);
        }

        public async Task SendEmailAsyncChangePassword(DTOEmail userData)
        {

            var usuarioDB = await _context.Usuarios.AsTracking().FirstOrDefaultAsync(x => x.Email == userData.ToEmail);

            DateTime fecha = DateTime.Now.AddHours(+1);
            Guid miGuid = Guid.NewGuid();
            string textoEnlace = Convert.ToBase64String(miGuid.ToByteArray());
            textoEnlace = textoEnlace.Replace("=", "").Replace("+", "").Replace("/", "").Replace("?", "").Replace("&", "").Replace("!", "").Replace("¡", "");
            usuarioDB.EnlaceCambioPass = textoEnlace;
            usuarioDB.FechaEnlaceCambioPass = fecha;

            var ruta = $"Para restablecer su contraseña haga click en este enlace: <a href='http://localhost:4200/shared/recover-pass/{textoEnlace}'>Recuperar contraseña</a>";
            //var ruta = $"Para restablecer su contraseña haga click en este enlace: <a href='{_httpContextAccessor.HttpContext.Request.Scheme}://localhost:4200/shared/recover-pass/{textoEnlace}'>Recuperar contraseña</a>";
            await _newStringGuid.SaveNewStringGuid(usuarioDB);

            var email = new MimeMessage();
            email.From.Add(MailboxAddress.Parse(_config.GetSection("Email:UserName").Value));
            email.To.Add(MailboxAddress.Parse(userData.ToEmail));
            email.Subject = "Recuperar contraseña";
            email.Body = new TextPart(TextFormat.Html)
            {
                Text = ruta
            };

            using var smtp = new SmtpClient();
            await smtp.ConnectAsync(
                _config.GetSection("Email:Host").Value,
                Convert.ToInt32(_config.GetSection("Email:Port").Value),
                SecureSocketOptions.StartTls
            );

            await smtp.AuthenticateAsync(_config.GetSection("Email:UserName").Value, _config.GetSection("Email:PassWord").Value);
            await smtp.SendAsync(email);
            await smtp.DisconnectAsync(true);

        }
       
        //Metodo que controla el cambio de email
        public async Task SendEmailAsyncEmailChanged(DTOEmailNotification emailNotification)
        {
            var email = new MimeMessage();
            //Va al archivo appsetings.json y toma la informacion del email que en el se alberga
            email.From.Add(MailboxAddress.Parse(_config.GetSection("Email:UserName").Value));
            //Manda un correo al email proporcionado
            email.To.Add(MailboxAddress.Parse(emailNotification.ToEmail));
            //Asunto del email
            email.Subject = "Cambio de Email";

            var ruta = $"Su email ha sido cambiado a {emailNotification.NewEmail}. En caso de que usted no haya cambiado el email contacte con el administrador del sitio. Este email no admite respuesta";
            //El curpo del email
            email.Body = new TextPart(TextFormat.Html)
            {
                Text = ruta
            };
            //Conexion con el servicio de correo electronico
            using var smtp = new SmtpClient();
            await smtp.ConnectAsync(
                _config.GetSection("Email:Host").Value,
                Convert.ToInt32(_config.GetSection("Email:Port").Value),
                SecureSocketOptions.StartTls
            );
            //Autenticacion del correo electronico
            await smtp.AuthenticateAsync(_config.GetSection("Email:UserName").Value, _config.GetSection("Email:PassWord").Value);
            //Realizacion del envio
            await smtp.SendAsync(email);
            await smtp.DisconnectAsync(true);
        }


    }
}

