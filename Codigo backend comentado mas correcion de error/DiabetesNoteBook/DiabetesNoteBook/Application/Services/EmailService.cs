using MailKit.Security;
using MimeKit;
using MimeKit.Text;
using SmtpClient = MailKit.Net.Smtp.SmtpClient;
using DiabetesNoteBook.Infrastructure.Interfaces;
using DiabetesNoteBook.Domain.Models;
using Microsoft.EntityFrameworkCore;
using DiabetesNoteBook.Application.Interfaces;
using DiabetesNoteBook.Application.DTOs;

namespace DiabetesNoteBook.Application.Services
{
    //Hemos creado una interfaz para que el componente sea reutilizable por eso esta clase se ha
    //vinculado a una interfaz.
    public class EmailService : IEmailService
    {
        //Llamamo a lo que se va a usar para que este servicio funcione
        private readonly IConfiguration _config;
        private readonly IHttpContextAccessor _httpContextAccessor;
        private readonly INewStringGuid _newStringGuid;
        private readonly DiabetesNoteBookContext _context;
        //Creamos el constructor
        public EmailService(IConfiguration config, IHttpContextAccessor httpContextAccessor, INewStringGuid newStringGuid, DiabetesNoteBookContext context)
        {
            _config = config;
            _httpContextAccessor = httpContextAccessor;
            _newStringGuid = newStringGuid;
            _context = context;
        }
        //Agregamos el metodo que esta en la interfaz
        public async Task SendEmailAsyncRegister(DTOEmail userData)
        {
            //Buscamos al usuario por su email
            var usuarioDB = await _context.Usuarios.AsTracking().FirstOrDefaultAsync(x => x.Email == userData.ToEmail);
            //Logica para generar el token el cual se encarga de que sea unico ese correo
            //En realidad token no es se puede dicir que genera un identificador unico
            Guid miGuid = Guid.NewGuid();
            string textoEnlace = Convert.ToBase64String(miGuid.ToByteArray());
            //De ese token que genera quitamos los simbolos que puedan dar problemas
            textoEnlace = textoEnlace.Replace("=", "").Replace("+", "").Replace("/", "").Replace("?", "").Replace("&", "").Replace("!", "").Replace("¡", "");
            //Asignamos ese enlace que genera a un campo de la tabla que se llama EnlaceCambioPass
            usuarioDB.EnlaceCambioPass = textoEnlace;
            //Se gurda los cambios y actualiza ese token.
            await _newStringGuid.SaveNewStringGuid(usuarioDB);
            //Esta variable almacena una platilla html.
            var ruta = $"<!DOCTYPE html>\r\n<html xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" lang=\"en\">\r\n\r\n<head>\r\n  <title></title>\r\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <!--[if mso]><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch><o:AllowPNG/></o:OfficeDocumentSettings></xml><![endif]--><!--[if !mso]><!-->\r\n  <link href=\"https://fonts.googleapis.com/css?family=Montserrat\" rel=\"stylesheet\" type=\"text/css\"><!--<![endif]-->\r\n  <script type=\"text/javascript\"\r\n    src=\"https://ff.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=78UTXEEdlnyZ0U0VNoTrpsFwGY4obvXbaCZJ-81jbCWVO5z39JiYEWFQB9onAbaWRCOCP4GZdyShQCd4Nk6OOJ8AhCO4baBXbb2QuUGNI98D9Gmc-JIZ5ujierpjOIIp\"\r\n    charset=\"UTF-8\"></script>\r\n  <link rel=\"stylesheet\" crossorigin=\"anonymous\"\r\n    href=\"https://ff.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly8wazZnMXdycWRoLnByZXZpZXctcG9zdGVkc3R1ZmYuY29tL1YyLXpQMGwtOEpjaC1aU2poLVRSZ2Uv\" />\r\n  <style>\r\n    * {{\r\n      box-sizing: border-box;\r\n    }}\r\n\r\n    body {{\r\n      margin: 0;\r\n      padding: 0;\r\n    }}\r\n\r\n    a[x-apple-data-detectors] {{\r\n      color: inherit !important;\r\n      text-decoration: inherit !important;\r\n    }}\r\n\r\n    #MessageViewBody a {{\r\n      color: inherit;\r\n      text-decoration: none;\r\n    }}\r\n\r\n    p {{\r\n      line-height: inherit\r\n    }}\r\n\r\n    .desktop_hide,\r\n    .desktop_hide table {{\r\n      mso-hide: all;\r\n      display: none;\r\n      max-height: 0px;\r\n      overflow: hidden;\r\n    }}\r\n\r\n    .image_block img+div {{\r\n      display: none;\r\n    }}\r\n\r\n    @media (max-width:700px) {{\r\n\r\n      .desktop_hide table.icons-inner,\r\n      .social_block.desktop_hide .social-table {{\r\n        display: inline-block !important;\r\n      }}\r\n\r\n      .icons-inner {{\r\n        text-align: center;\r\n      }}\r\n\r\n      .icons-inner td {{\r\n        margin: 0 auto;\r\n      }}\r\n\r\n      .mobile_hide {{\r\n        display: none;\r\n      }}\r\n\r\n      .row-content {{\r\n        width: 100% !important;\r\n      }}\r\n\r\n      .stack .column {{\r\n        width: 100%;\r\n        display: block;\r\n      }}\r\n\r\n      .mobile_hide {{\r\n        min-height: 0;\r\n        max-height: 0;\r\n        max-width: 0;\r\n        overflow: hidden;\r\n        font-size: 0px;\r\n      }}\r\n\r\n      .desktop_hide,\r\n      .desktop_hide table {{\r\n        display: table !important;\r\n        max-height: none !important;\r\n      }}\r\n    }}\r\n  </style>\r\n</head>\r\n\r\n<body style=\"background-color: #FFFFFF; margin: 0; padding: 0; -webkit-text-size-adjust: none; text-size-adjust: none;\">\r\n  <table class=\"nl-container\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #FFFFFF;\">\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <table class=\"row row-1\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\"\r\n            style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #eff9f0; background-image: url('https://d1oco4z2z1fhwp.cloudfront.net/templates/default/6451/bg_hero_nut.png'); background-position: center top; background-repeat: no-repeat;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:35px;line-height:35px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <table class=\"icons_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"vertical-align: middle; color: #000000; font-family: inherit; font-size: 14px; text-align: center;\">\r\n                                <table class=\"alignment\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n                                  align=\"center\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                                  <tr>\r\n                                    <td\r\n                                      style=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px;\">\r\n                                      <img class=\"icon\"\r\n                                        src=\"https://cdn.discordapp.com/attachments/1190453964605493328/1201495964268122144/logoTexto.png?ex=65ca0750&is=65b79250&hm=7bee5c5d02a89494bdbfb1861f505bcecf642d48e6b4e71434b00d0417e777e6&\"\r\n                                        height=\"64\" width=\"417\" align=\"center\"\r\n                                        style=\"display: block; height: auto; margin: 0 auto; border: 0;\">\r\n                                    </td>\r\n                                  </tr>\r\n                                </table>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <div class=\"spacer_block block-3\" style=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <table class=\"heading_block block-4\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\" style=\"text-align:center;width:100%;\">\r\n                                <h1\r\n                                  style=\"margin: 0; color: #c4eed0; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 44px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: center; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 52.8px;\">\r\n                                  <span class=\"tinyMce-placeholder\"></span>\r\n                                </h1>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"heading_block block-5\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\" style=\"text-align:center;width:100%;\">\r\n                                <h1\r\n                                  style=\"margin: 0; color: #c4eed0; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 44px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: center; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 52.8px;\">\r\n                                  <span class=\"tinyMce-placeholder\">Tu salud esta en tus Dedos!!</span>\r\n                                </h1>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <div class=\"spacer_block block-6\" style=\"height:10px;line-height:10px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <div class=\"spacer_block block-7\" style=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <div class=\"spacer_block block-8\" style=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-2\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-position: center top;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"50%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:45px;line-height:45px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <table class=\"heading_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n                                <h2\r\n                                  style=\"margin: 0; color: #528252; direction: ltr; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 18px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 21.599999999999998px;\">\r\n                                  <span class=\"tinyMce-placeholder\">Te damos la Bienvenida</span>\r\n                                </h2>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"heading_block block-3\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:5px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n                                <h1\r\n                                  style=\"margin: 0; color: #171614; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 30px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n                                  <span class=\"tinyMce-placeholder\">CONFIRMA TU RESGISTRO AQUÍ</span>\r\n                                </h1>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"button_block block-4\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:10px;padding-right:10px;padding-top:20px;text-align:left;\">\r\n                                <div class=\"alignment\" align=\"left\"><!--[if mso]>\r\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"www.example.com\" style=\"height:42px;width:144px;v-text-anchor:middle;\" arcsize=\"10%\" stroke=\"false\" fillcolor=\"#528252\">\r\n<w:anchorlock/>\r\n<v:textbox inset=\"0px,0px,0px,0px\">\r\n<center style=\"color:#00000; font-family:Tahoma, sans-serif; font-size:16px\">\r\n<![endif]--><a href=\"{_httpContextAccessor.HttpContext.Request.Scheme}://{_httpContextAccessor.HttpContext.Request.Host}/api/Users/validarRegistro/{usuarioDB.Id}/{textoEnlace}\"\r\n                                    target=\"_blank\"\r\n                                    style=\"text-decoration:none;display:inline-block;color:#fffff;background-color:#528252;border-radius:4px;width:auto;border-top:0px solid transparent;font-weight:400;border-right:0px solid transparent;border-bottom:0px solid transparent;border-left:0px solid transparent;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:16px;text-align:center;mso-border-alt:none;word-break:keep-all;\"><span\r\n                                      style=\"padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;letter-spacing:normal;\"><span\r\n                                        style=\"word-break: break-word; line-height: 32px;\">Púlsame&nbsp;</span></span></a><!--[if mso]></center></v:textbox></v:roundrect><![endif]-->\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"paragraph_block block-5\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\"\r\n                            style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:15px;padding-left:10px;padding-right:10px;padding-top:10px;\">\r\n                                <div\r\n                                  style=\"color:#7a7a7a;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;font-size:17px;line-height:180%;text-align:left;mso-line-height-alt:30.6px;\">\r\n                                  <p style=\"margin: 0;\">Nos alegra mucho tenerte aquí como parte de nuestra comunidad.\r\n                                  </p>\r\n                                  <p style=\"margin: 0;\">&nbsp;</p>\r\n                                  <p style=\"margin: 0;\">No respondas a este email, eso no confirmara tu dirección email.\r\n                                    Para confirmar el proceso de confirmación debes hacer clic en el link de mas arriba.\r\n                                  </p>\r\n                                  <p style=\"margin: 0;\">&nbsp;</p>\r\n                                  <p style=\"margin: 0;\">&nbsp;</p>\r\n                                  <p style=\"margin: 0;\">&nbsp;</p>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                        <td class=\"column column-2\" width=\"50%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"image_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:30px;padding-left:5px;padding-top:60px;width:100%;padding-right:0px;\">\r\n                                <div class=\"alignment\" align=\"right\" style=\"line-height:10px\">\r\n                                  <div style=\"max-width: 333px;\"><img\r\n                                      src=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/imported/TRge-20240122-193812/logo.png\"\r\n                                      style=\"display: block; height: auto; border: 0; width: 100%;\" width=\"333\"\r\n                                      alt=\"Happy Girl\" title=\"Happy Girl\"></div>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-3\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #c4eed0;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-4\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #c4eed0;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"33.333333333333336%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"icons_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"vertical-align: middle; color: #000000; font-family: inherit; font-size: 14px; padding-left: 10px; padding-right: 10px; text-align: left;\">\r\n                                <table class=\"alignment\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n                                  align=\"left\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                                  <tr>\r\n                                    <td\r\n                                      style=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px;\">\r\n                                      <img class=\"icon\"\r\n                                        src=\"https://cdn.discordapp.com/attachments/1190453964605493328/1201495964268122144/logoTexto.png?ex=65ca0750&is=65b79250&hm=7bee5c5d02a89494bdbfb1861f505bcecf642d48e6b4e71434b00d0417e777e6&\"\r\n                                        height=\"16\" width=\"104\" align=\"center\"\r\n                                        style=\"display: block; height: auto; margin: 0 auto; border: 0;\">\r\n                                    </td>\r\n                                  </tr>\r\n                                </table>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"paragraph_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\"\r\n                            style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:20px;padding-right:20px;padding-top:10px;\">\r\n                                <div\r\n                                  style=\"color:#000000;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:14px;line-height:200%;text-align:left;mso-line-height-alt:28px;\">\r\n                                  <p style=\"margin: 0;\">Tu salud esta en</p>\r\n                                  <p style=\"margin: 0;\">tus dedos...</p>\r\n                                  <p style=\"margin: 0;\">¡Descúbrenos!</p>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                        <td class=\"column column-2\" width=\"33.333333333333336%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"heading_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\" style=\"padding-left:20px;text-align:center;width:100%;\">\r\n                                <h1\r\n                                  style=\"margin: 0; color: #000000; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 18px; font-weight: normal; line-height: 200%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n                                  <strong>Links</strong>\r\n                                </h1>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"social_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:20px;padding-right:10px;padding-top:10px;text-align:left;\">\r\n                                <div class=\"alignment\" align=\"left\">\r\n                                  <table class=\"social-table\" width=\"144px\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                                    role=\"presentation\"\r\n                                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block;\">\r\n                                    <tr>\r\n                                      <td style=\"padding:0 4px 0 0;\"><a href=\"https://www.facebook.com\"\r\n                                          target=\"_blank\"><img\r\n                                            src=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/t-only-logo-white/facebook@2x.png\"\r\n                                            width=\"32\" height=\"32\" alt=\"Facebook\" title=\"facebook\"\r\n                                            style=\"display: block; height: auto; border: 0;\"></a></td>\r\n                                      <td style=\"padding:0 4px 0 0;\"><a href=\"https://www.twitter.com\"\r\n                                          target=\"_blank\"><img\r\n                                            src=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/t-only-logo-white/twitter@2x.png\"\r\n                                            width=\"32\" height=\"32\" alt=\"Twitter\" title=\"twitter\"\r\n                                            style=\"display: block; height: auto; border: 0;\"></a></td>\r\n                                      <td style=\"padding:0 4px 0 0;\"><a href=\"https://www.linkedin.com\"\r\n                                          target=\"_blank\"><img\r\n                                            src=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/t-only-logo-white/linkedin@2x.png\"\r\n                                            width=\"32\" height=\"32\" alt=\"Linkedin\" title=\"linkedin\"\r\n                                            style=\"display: block; height: auto; border: 0;\"></a></td>\r\n                                      <td style=\"padding:0 4px 0 0;\"><a href=\"https://www.instagram.com\"\r\n                                          target=\"_blank\"><img\r\n                                            src=\"https://app-rsrc.getbee.io/public/resources/social-networks-icon-sets/t-only-logo-white/instagram@2x.png\"\r\n                                            width=\"32\" height=\"32\" alt=\"Instagram\" title=\"instagram\"\r\n                                            style=\"display: block; height: auto; border: 0;\"></a></td>\r\n                                    </tr>\r\n                                  </table>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                        <td class=\"column column-3\" width=\"33.333333333333336%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"heading_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\" style=\"padding-left:20px;text-align:center;width:100%;\">\r\n                                <h1\r\n                                  style=\"margin: 0; color: #000000; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 18px; font-weight: normal; line-height: 200%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n                                  <strong>Contact</strong>\r\n                                </h1>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"paragraph_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\"\r\n                            style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:20px;padding-right:20px;padding-top:10px;\">\r\n                                <div\r\n                                  style=\"color:#a9a9a9;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:14px;line-height:120%;text-align:left;mso-line-height-alt:16.8px;\">\r\n                                  <p style=\"margin: 0; word-break: break-word;\">glucocontrol44@gmail.com</p>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"paragraph_block block-3\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\"\r\n                            style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:20px;padding-right:20px;padding-top:10px;\">\r\n                                <div\r\n                                  style=\"color:#a9a9a9;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:14px;line-height:120%;text-align:left;mso-line-height-alt:16.8px;\">\r\n                                  <p style=\"margin: 0; word-break: break-word;\"><a href=\"http://www.example.com\"\r\n                                      target=\"_blank\" style=\"text-decoration: none; color: #000000;\" rel=\"noopener\">Help\r\n                                      Center</a></p>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-5\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #c4eed0;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-6\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"icons_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"vertical-align: middle; color: #000000; font-family: 'Inter', sans-serif; font-size: 15px; padding-bottom: 5px; padding-top: 5px; text-align: center;\">\r\n                                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n                                  style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                                  <tr>\r\n                                    <td class=\"alignment\" style=\"vertical-align: middle; text-align: center;\">\r\n                                      <!--[if vml]><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"display:inline-block;padding-left:0px;padding-right:0px;mso-table-lspace: 0pt;mso-table-rspace: 0pt;\"><![endif]-->\r\n                                      <!--[if !vml]><!-->\r\n                                      <table class=\"icons-inner\"\r\n                                        style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block; margin-right: -4px; padding-left: 0px; padding-right: 0px;\"\r\n                                        cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"><!--<![endif]-->\r\n\r\n                                      </table>\r\n                                    </td>\r\n                                  </tr>\r\n                                </table>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table><!-- End -->\r\n</body>\r\n\r\n</html>";
            //Hacemos uso del paquete mailkit
            var email = new MimeMessage();
            //Decimos de quien es el correo electronico
            email.From.Add(MailboxAddress.Parse(_config.GetSection("Email:UserName").Value));
            //A quien va dirigido
            email.To.Add(MailboxAddress.Parse(userData.ToEmail));
            //Asunto del correo
            email.Subject = "Confirmar Email";
            //Lo que contiene el correo
            email.Body = new TextPart(TextFormat.Html)
            {
                Text = ruta
            };
            //Logica necesaria para que el servicio funcione y haga la conexion desconexion y autentificacion
            using var smtp = new SmtpClient();
            await smtp.ConnectAsync(
                _config.GetSection("Email:Host").Value,
                Convert.ToInt32(_config.GetSection("Email:Port").Value),
                SecureSocketOptions.StartTls
            );

            await smtp.AuthenticateAsync(_config.GetSection("Email:UserName").Value, _config.GetSection("Email:PassWord").Value);
            await smtp.SendAsync(email);
            await smtp.DisconnectAsync(true);
        }
        //Agregamos el metodo que tiene la interfaz junto al DTOEmail
        public async Task SendEmailAsyncChangePassword(DTOEmail userData)
        {
            //Buscamos al usuario por su email
            var usuarioDB = await _context.Usuarios.AsTracking().FirstOrDefaultAsync(x => x.Email == userData.ToEmail);
            //Establecemos una fecha de duracion que es lo que va a durar el enalce
            DateTime fecha = DateTime.Now.AddHours(+1);
            //Creacion de identificador unico
            Guid miGuid = Guid.NewGuid();
            string textoEnlace = Convert.ToBase64String(miGuid.ToByteArray());
            //De ese identificador unico quitamos los caracteres que puedan ser problematicos
            textoEnlace = textoEnlace.Replace("=", "").Replace("+", "").Replace("/", "").Replace("?", "").Replace("&", "").Replace("!", "").Replace("¡", "");
            //A EnlaceCambioPass le asignamos el identificador unico mas una fecha de vigencia
            usuarioDB.EnlaceCambioPass = textoEnlace;
            usuarioDB.FechaEnlaceCambioPass = fecha;
            //Agregado de html
            var ruta = $"<!DOCTYPE html>\r\n<html xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" lang=\"en\">\r\n\r\n<head>\r\n  <title></title>\r\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <!--[if mso]><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch><o:AllowPNG/></o:OfficeDocumentSettings></xml><![endif]--><!--[if !mso]><!-->\r\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900\"\r\n    rel=\"stylesheet\" type=\"text/css\"><!--<![endif]-->\r\n  <script type=\"text/javascript\"\r\n    src=\"https://ff.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=YjVJ3s2Xnmna5fr7xbjVJADRpL1roNwtQYfMggP_CBE7zNz9ICo31Rlk15jNynFqf3ghChUEAw3OGLvtefslaDxbeWtAB3Rk2q7B-DoZTNbeIloKfENsAXqStCy8Syo1D4YPmM8TgF8V3xeyKq-yrA\"\r\n    charset=\"UTF-8\"></script>\r\n  <link rel=\"stylesheet\" crossorigin=\"anonymous\"\r\n    href=\"https://ff.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly8wazZnMXdycWRoLnByZXZpZXctcG9zdGVkc3R1ZmYuY29tL1YyLXpQMGwtOEpjaC1aU2poLVFFaXYvd3d3LmV4YW1wbGUuY29tLw\" />\r\n  <style>\r\n    * {{\r\n      box-sizing: border-box;\r\n    }}\r\n\r\n    body {{\r\n      margin: 0;\r\n      padding: 0;\r\n    }}\r\n\r\n    a[x-apple-data-detectors] {{\r\n      color: inherit !important;\r\n      text-decoration: inherit !important;\r\n    }}\r\n\r\n    #MessageViewBody a {{\r\n      color: inherit;\r\n      text-decoration: none;\r\n    }}\r\n\r\n    p {{\r\n      line-height: inherit\r\n    }}\r\n\r\n    .desktop_hide,\r\n    .desktop_hide table {{\r\n      mso-hide: all;\r\n      display: none;\r\n      max-height: 0px;\r\n      overflow: hidden;\r\n    }}\r\n\r\n    .image_block img+div {{\r\n      display: none;\r\n    }}\r\n\r\n    @media (max-width:700px) {{\r\n      .desktop_hide table.icons-inner {{\r\n        display: inline-block !important;\r\n      }}\r\n\r\n      .icons-inner {{\r\n        text-align: center;\r\n      }}\r\n\r\n      .icons-inner td {{\r\n        margin: 0 auto;\r\n      }}\r\n\r\n      .image_block div.fullWidth {{\r\n        max-width: 100% !important;\r\n      }}\r\n\r\n      .mobile_hide {{\r\n        display: none;\r\n      }}\r\n\r\n      .row-content {{\r\n        width: 100% !important;\r\n      }}\r\n\r\n      .stack .column {{\r\n        width: 100%;\r\n        display: block;\r\n      }}\r\n\r\n      .mobile_hide {{\r\n        min-height: 0;\r\n        max-height: 0;\r\n        max-width: 0;\r\n        overflow: hidden;\r\n        font-size: 0px;\r\n      }}\r\n\r\n      .desktop_hide,\r\n      .desktop_hide table {{\r\n        display: table !important;\r\n        max-height: none !important;\r\n      }}\r\n    }}\r\n  </style>\r\n</head>\r\n\r\n<body style=\"background-color: #FFFFFF; margin: 0; padding: 0; -webkit-text-size-adjust: none; text-size-adjust: none;\">\r\n  <table class=\"nl-container\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #FFFFFF;\">\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <table class=\"row row-1\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\"\r\n            style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1; background-image: url('https://d1oco4z2z1fhwp.cloudfront.net/templates/default/6451/bg_hero_nut.png'); background-position: center top; background-repeat: no-repeat;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:35px;line-height:35px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <table class=\"icons_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"vertical-align: middle; color: #000000; font-family: inherit; font-size: 14px; text-align: center;\">\r\n                                <table class=\"alignment\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n                                  align=\"center\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                                  <tr>\r\n                                    <td\r\n                                      style=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px;\">\r\n                                      <img class=\"icon\"\r\n                                        src=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/logoTexto%20%282%29.svg\"\r\n                                        height=\"32\" width=\"234\" align=\"center\"\r\n                                        style=\"display: block; height: auto; margin: 0 auto; border: 0;\">\r\n                                    </td>\r\n                                  </tr>\r\n                                </table>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <div class=\"spacer_block block-3\" style=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <div class=\"spacer_block block-4\" style=\"height:10px;line-height:10px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <table class=\"button_block block-5\" width=\"100%\" border=\"0\" cellpadding=\"10\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\">\r\n                                <div class=\"alignment\" align=\"center\"><!--[if mso]>\r\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"www.example.com\" style=\"height:68px;width:447px;v-text-anchor:middle;\" arcsize=\"6%\" stroke=\"false\" fill=\"false\">\r\n<w:anchorlock/>\r\n<v:textbox inset=\"0px,0px,0px,0px\">\r\n<center style=\"color:#000000; font-family:'Trebuchet MS', Tahoma, sans-serif; font-size:29px\">\r\n<![endif]--><a href=\"www.example.com\" target=\"_blank\"\r\n                                    style=\"text-decoration:none;display:inline-block;color:#000000;background-color:transparent;border-radius:4px;width:auto;border-top:0px solid transparent;font-weight:700;border-right:0px solid transparent;border-bottom:0px solid transparent;border-left:0px solid transparent;padding-top:5px;padding-bottom:5px;font-family:'Montserrat', 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif;font-size:29px;text-align:center;mso-border-alt:none;word-break:keep-all;\"><span\r\n                                      style=\"padding-left:20px;padding-right:20px;font-size:29px;display:inline-block;letter-spacing:normal;\"><span\r\n                                        style=\"word-break: break-word; line-height: 58px;\">Tu salud esta en tus\r\n                                        Dedos</span></span></a><!--[if mso]></center></v:textbox></v:roundrect><![endif]-->\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <div class=\"spacer_block block-6\" style=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <div class=\"spacer_block block-7\" style=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-2\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-3\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-position: center top;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"50%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:45px;line-height:45px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                          <table class=\"heading_block block-2\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n                                <h2\r\n                                  style=\"margin: 0; color: #7a7a7a; direction: ltr; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 18px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 21.599999999999998px;\">\r\n                                  <span class=\"tinyMce-placeholder\">Te damos la Bienvenida</span>\r\n                                </h2>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"heading_block block-3\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:5px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n                                <h1\r\n                                  style=\"margin: 0; color: #171614; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 30px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n                                  <span class=\"tinyMce-placeholder\">¿QUIERES CAMBIAR TU CONTRASEÑA?</span>\r\n                                </h1>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <table class=\"button_block block-4\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"padding-bottom:10px;padding-left:10px;padding-right:10px;padding-top:20px;text-align:left;\">\r\n                                <div class=\"alignment\" align=\"left\"><!--[if mso]>\r\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"www.example.com\" style=\"height:42px;width:99px;v-text-anchor:middle;\" arcsize=\"10%\" stroke=\"false\" fillcolor=\"#528252\">\r\n<w:anchorlock/>\r\n<v:textbox inset=\"0px,0px,0px,0px\">\r\n<center style=\"color:#000000; font-family:Tahoma, sans-serif; font-size:16px\">\r\n<![endif]--><a href=\"http://localhost:4200/shared/recover-pass/{textoEnlace}\" target=\"_blank\"\r\n                                    style=\"text-decoration:none;display:inline-block;color:#ffffff;background-color:#528252;border-radius:4px;width:auto;border-top:0px solid transparent;font-weight:400;border-right:0px solid transparent;border-bottom:0px solid transparent;border-left:0px solid transparent;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:16px;text-align:center;mso-border-alt:none;word-break:keep-all;\"><span\r\n                                      style=\"padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;letter-spacing:normal;\"><span\r\n                                        style=\"word-break: break-word; line-height: 32px;\">Púlsame</span></span></a><!--[if mso]></center></v:textbox></v:roundrect><![endif]-->\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                        <td class=\"column column-2\" width=\"50%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"image_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\" style=\"width:100%;padding-right:0px;padding-left:0px;\">\r\n                                <div class=\"alignment\" align=\"center\" style=\"line-height:10px\">\r\n                                  <div class=\"fullWidth\" style=\"max-width: 340px;\"><img\r\n                                      src=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/logo.png\"\r\n                                      style=\"display: block; height: auto; border: 0; width: 100%;\" width=\"340\"\r\n                                      alt=\"Cuadeno con gota de agua\" title=\"Cuadeno con gota de agua\"></div>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-4\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <div class=\"spacer_block block-1\" style=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <table class=\"row row-5\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff;\">\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                    role=\"presentation\"\r\n                    style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; background-color: #ffffff; width: 680px; margin: 0 auto;\"\r\n                    width=\"680\">\r\n                    <tbody>\r\n                      <tr>\r\n                        <td class=\"column column-1\" width=\"100%\"\r\n                          style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n                          <table class=\"icons_block block-1\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n                            role=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                            <tr>\r\n                              <td class=\"pad\"\r\n                                style=\"vertical-align: middle; color: #1e0e4b; font-family: 'Inter', sans-serif; font-size: 15px; padding-bottom: 5px; padding-top: 5px; text-align: center;\">\r\n                                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n                                  style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n                                  <tr>\r\n                                    <td class=\"alignment\" style=\"vertical-align: middle; text-align: center;\">\r\n                                      <!--[if vml]><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"display:inline-block;padding-left:0px;padding-right:0px;mso-table-lspace: 0pt;mso-table-rspace: 0pt;\"><![endif]-->\r\n                                      <!--[if !vml]><!-->\r\n                                      <table class=\"icons-inner\"\r\n                                        style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block; margin-right: -4px; padding-left: 0px; padding-right: 0px;\"\r\n                                        cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"><!--<![endif]-->\r\n\r\n                                      </table>\r\n                                    </td>\r\n                                  </tr>\r\n                                </table>\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table><!-- End -->\r\n</body>\r\n\r\n</html>";
            //var ruta = $"<!DOCTYPE html>\r\n<html xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" lang=\"en\">\r\n\r\n<head>\r\n\t<title></title>\r\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n\t<!--[if mso]><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch><o:AllowPNG/></o:OfficeDocumentSettings></xml><![endif]--><!--[if !mso]><!-->\r\n\t<link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900\"\r\n\t\trel=\"stylesheet\" type=\"text/css\"><!--<![endif]-->\r\n\t<style>\r\n\t\t* {{\r\n\t\t\tbox-sizing: border-box;\r\n\t\t}}\r\n\r\n\t\tbody {{\r\n\t\t\tmargin: 0;\r\n\t\t\tpadding: 0;\r\n\t\t}}\r\n\r\n\t\ta[x-apple-data-detectors] {{\r\n\t\t\tcolor: inherit !important;\r\n\t\t\ttext-decoration: inherit !important;\r\n\t\t}}\r\n\r\n\t\t#MessageViewBody a {{\r\n\t\t\tcolor: inherit;\r\n\t\t\ttext-decoration: none;\r\n\t\t}}\r\n\r\n\t\tp {{\r\n\t\t\tline-height: inherit\r\n\t\t}}\r\n\r\n\t\t.desktop_hide,\r\n\t\t.desktop_hide table {{\r\n\t\t\tmso-hide: all;\r\n\t\t\tdisplay: none;\r\n\t\t\tmax-height: 0px;\r\n\t\t\toverflow: hidden;\r\n\t\t}}\r\n\r\n\t\t.image_block img+div {{\r\n\t\t\tdisplay: none;\r\n\t\t}}\r\n\r\n\t\t@media (max-width:700px) {{\r\n\t\t\t.desktop_hide table.icons-inner {{\r\n\t\t\t\tdisplay: inline-block !important;\r\n\t\t\t}}\r\n\r\n\t\t\t.icons-inner {{\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}}\r\n\r\n\t\t\t.icons-inner td {{\r\n\t\t\t\tmargin: 0 auto;\r\n\t\t\t}}\r\n\r\n\t\t\t.image_block div.fullWidth {{\r\n\t\t\t\tmax-width: 100% !important;\r\n\t\t\t}}\r\n\r\n\t\t\t.mobile_hide {{\r\n\t\t\t\tdisplay: none;\r\n\t\t\t}}\r\n\r\n\t\t\t.row-content {{\r\n\t\t\t\twidth: 100% !important;\r\n\t\t\t}}\r\n\r\n\t\t\t.stack .column {{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}}\r\n\r\n\t\t\t.mobile_hide {{\r\n\t\t\t\tmin-height: 0;\r\n\t\t\t\tmax-height: 0;\r\n\t\t\t\tmax-width: 0;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\tfont-size: 0px;\r\n\t\t\t}}\r\n\r\n\t\t\t.desktop_hide,\r\n\t\t\t.desktop_hide table {{\r\n\t\t\t\tdisplay: table !important;\r\n\t\t\t\tmax-height: none !important;\r\n\t\t\t}}\r\n\t\t}}\r\n\t</style>\r\n</head>\r\n\r\n<body style=\"background-color: #FFFFFF; margin: 0; padding: 0; -webkit-text-size-adjust: none; text-size-adjust: none;\">\r\n\t<table class=\"nl-container\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #FFFFFF;\">\r\n\t\t<tbody>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<table class=\"row row-1\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1; background-image: url('https://d1oco4z2z1fhwp.cloudfront.net/templates/default/6451/bg_hero_nut.png'); background-position: center top; background-repeat: no-repeat;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"680\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:35px;line-height:35px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; color: #000000; font-family: inherit; font-size: 14px; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"alignment\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\" align=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img class=\"icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/logoTexto%20%282%29.svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"32\" width=\"234\" align=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; margin: 0 auto; border: 0;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:10px;line-height:10px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"button_block block-5\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"10\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"alignment\" align=\"center\"><!--[if mso]>\r\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"www.example.com\" style=\"height:68px;width:447px;v-text-anchor:middle;\" arcsize=\"6%\" stroke=\"false\" fill=\"false\">\r\n<w:anchorlock/>\r\n<v:textbox inset=\"0px,0px,0px,0px\">\r\n<center style=\"color:#000000; font-family:'Trebuchet MS', Tahoma, sans-serif; font-size:29px\">\r\n<![endif]--><a href=\"www.example.com\" target=\"_blank\" style=\"text-decoration:none;display:inline-block;color:#000000;background-color:transparent;border-radius:4px;width:auto;border-top:0px solid transparent;font-weight:700;border-right:0px solid transparent;border-bottom:0px solid transparent;border-left:0px solid transparent;padding-top:5px;padding-bottom:5px;font-family:'Montserrat', 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif;font-size:29px;text-align:center;mso-border-alt:none;word-break:keep-all;\"><span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-left:20px;padding-right:20px;font-size:29px;display:inline-block;letter-spacing:normal;\"><span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"word-break: break-word; line-height: 58px;\">Tu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsalud esta en tus\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDedos</span></span></a><!--[if mso]></center></v:textbox></v:roundrect><![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-6\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:20px;line-height:20px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-7\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-2\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"680\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-3\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-position: center top;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"680\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"50%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:45px;line-height:45px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-2\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h2\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #7a7a7a; direction: ltr; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 18px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 21.599999999999998px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tinyMce-placeholder\">Te damos la\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBienvenida</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"heading_block block-3\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:5px;padding-left:10px;padding-right:10px;text-align:center;width:100%;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin: 0; color: #171614; direction: ltr; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; font-size: 30px; font-weight: 700; letter-spacing: normal; line-height: 120%; text-align: left; margin-top: 0; margin-bottom: 0; mso-line-height-alt: 36px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"tinyMce-placeholder\">¿QUIERES CAMBIAR\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTU CONTRASEÑA?<a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref=\"http://localhost:4200/shared/recover-pass/{{textoEnlace}}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"></a></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"button_block block-4\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-bottom:10px;padding-left:10px;padding-right:10px;padding-top:20px;text-align:left;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"alignment\" align=\"left\"><!--[if mso]>\r\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"www.example.com\" style=\"height:42px;width:110px;v-text-anchor:middle;\" arcsize=\"10%\" stroke=\"false\" fillcolor=\"#528252\">\r\n<w:anchorlock/>\r\n<v:textbox inset=\"0px,0px,0px,0px\">\r\n<center style=\"color:#ffffff; font-family:Tahoma, sans-serif; font-size:16px\">\r\n<![endif]--><a href=\"www.example.com\" target=\"_blank\" style=\"text-decoration:none;display:inline-block;color:#ffffff;background-color:#528252;border-radius:4px;width:auto;border-top:0px solid transparent;font-weight:400;border-right:0px solid transparent;border-bottom:0px solid transparent;border-left:0px solid transparent;padding-top:5px;padding-bottom:5px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;font-size:16px;text-align:center;mso-border-alt:none;word-break:keep-all;\"><span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"padding-left:20px;padding-right:20px;font-size:16px;display:inline-block;letter-spacing:normal;\"><span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"word-break: break-word; line-height: 32px;\">Púlsame</span></span></a><!--[if mso]></center></v:textbox></v:roundrect><![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-2\" width=\"50%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"image_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%;padding-right:0px;padding-left:0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"alignment\" align=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"line-height:10px\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"fullWidth\" style=\"max-width: 340px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://020ed6c75c.imgdist.com/public/users/Integrators/BeeProAgency/1132153_1117736/logo.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; border: 0; width: 100%;\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"340\" alt=\"Cuadeno con gota de agua\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Cuadeno con gota de agua\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-4\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\" style=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"680\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-5\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #68c2f1;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; width: 680px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"680\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"spacer_block block-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"height:60px;line-height:60px;font-size:1px;\">&#8202;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t<table class=\"row row-6\" align=\"center\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff;\">\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<table class=\"row-content stack\" align=\"center\" border=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\t\tcellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; color: #000000; background-color: #ffffff; width: 680px; margin: 0 auto;\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"680\">\r\n\t\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"column column-1\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; padding-bottom: 5px; padding-top: 5px; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons_block block-1\" width=\"100%\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\" role=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"pad\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; color: #1e0e4b; font-family: 'Inter', sans-serif; font-size: 15px; padding-bottom: 5px; padding-top: 5px; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"alignment\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--[if vml]><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"display:inline-block;padding-left:0px;padding-right:0px;mso-table-lspace: 0pt;mso-table-rspace: 0pt;\"><![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--[if !vml]><!-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table class=\"icons-inner\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"mso-table-lspace: 0pt; mso-table-rspace: 0pt; display: inline-block; margin-right: -4px; padding-left: 0px; padding-right: 0px;\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"presentation\"><!--<![endif]-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"vertical-align: middle; text-align: center; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 6px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"http://designedwithbeefree.com/\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"text-decoration: none;\"><img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Beefree Logo\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"https://d1oco4z2z1fhwp.cloudfront.net/assets/Beefree-logo.png\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"32\" width=\"34\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: block; height: auto; margin: 0 auto; border: 0;\"></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"font-family: 'Inter', sans-serif; font-size: 15px; font-weight: undefined; color: #1e0e4b; vertical-align: middle; letter-spacing: undefined; text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"http://designedwithbeefree.com/\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"color: #1e0e4b; text-decoration: none;\">Designed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twith Beefree</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table><!-- End -->\r\n</body>\r\n\r\n</html>";
            //var ruta = $"Para restablecer su contraseña haga click en este enlace: <a href='http://localhost:4200/shared/recover-pass/{textoEnlace}'>Recuperar contraseña</a>";
            //var ruta = $"Para restablecer su contraseña haga click en este enlace: <a href='{_httpContextAccessor.HttpContext.Request.Scheme}://localhost:4200/shared/recover-pass/{textoEnlace}'>Recuperar contraseña</a>";
            //Actuzacion de los campos necesarios
            await _newStringGuid.SaveNewStringGuid(usuarioDB);
            //Hacemos uso del paquete mailkit
            var email = new MimeMessage();
            //Decimos de quien es el correo electronico
            email.From.Add(MailboxAddress.Parse(_config.GetSection("Email:UserName").Value));
            //A quien va dirigido el correo electronico
            email.To.Add(MailboxAddress.Parse(userData.ToEmail));
            //Asunto del correo electronico
            email.Subject = "Recuperar contraseña";
            //Lo que contiene el email
            email.Body = new TextPart(TextFormat.Html)
            {
                Text = ruta
            };
            //Logica necesaria para que el servicio funcione y haga la conexion desconexion y autentificacion
            using var smtp = new SmtpClient();
            await smtp.ConnectAsync(
                _config.GetSection("Email:Host").Value,
                Convert.ToInt32(_config.GetSection("Email:Port").Value),
                SecureSocketOptions.StartTls
            );

            await smtp.AuthenticateAsync(_config.GetSection("Email:UserName").Value, _config.GetSection("Email:PassWord").Value);
            await smtp.SendAsync(email);
            await smtp.DisconnectAsync(true);

        }
       
        //Metodo que controla el cambio de email
        public async Task SendEmailAsyncEmailChanged(DTOEmailNotification emailNotification)
        {
            var email = new MimeMessage();
            //Decimos de quien es el correo electronico
            email.From.Add(MailboxAddress.Parse(_config.GetSection("Email:UserName").Value));
            //Manda un correo al email proporcionado
            email.To.Add(MailboxAddress.Parse(emailNotification.ToEmail));
            //Asunto del email
            email.Subject = "Cambio de Email";

            var ruta = $"Su email ha sido cambiado a {emailNotification.NewEmail}. En caso de que usted no haya cambiado el email contacte con el administrador del sitio. Este email no admite respuesta";
            //El curpo del email
            email.Body = new TextPart(TextFormat.Html)
            {
                Text = ruta
            };
            //Conexion con el servicio de correo electronico
            using var smtp = new SmtpClient();
            await smtp.ConnectAsync(
                _config.GetSection("Email:Host").Value,
                Convert.ToInt32(_config.GetSection("Email:Port").Value),
                SecureSocketOptions.StartTls
            );
            //Autenticacion del correo electronico
            await smtp.AuthenticateAsync(_config.GetSection("Email:UserName").Value, _config.GetSection("Email:PassWord").Value);
            //Realizacion del envio
            await smtp.SendAsync(email);
            await smtp.DisconnectAsync(true);
        }


    }
}

